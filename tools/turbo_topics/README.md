# Turbo Topics

## Copyright Information

Turbo Topics is licensed under the GPL from David Blei. The original code can be found here:
http://www.cs.princeton.edu/~blei/topicmodeling.html

We include only the files that we need. In particular, the files `turbotopics.py`, `lda_topics.py`, and `turbotopics-readme.txt` (renamed) are from David Blei's code. We slightly modified `lda_topics.py` from Blei's version.

All other files in this directory are part of the Topical Guide, released under the conditions specified at http://nlp.cs.byu.edu/topical_guide

---

## Usage Information

### Recommended Method

The easiest way to use Turbo Topics is through `backend.py`. See the documentation at http://nlps.cs.byu.edu/topical_guide for information on how to use `backend.py` to run Turbo Topics.

### Manual Method

If you prefer to run Turbo Topics manually, follow these instructions:

#### Prerequisites

To add Turbo Topics information to the visualizer, you need:
1. A corpus file
2. A MALLET state file

#### Creating the Corpus File

To run Turbo Topics from a MALLET file:

1. Take the `mallet_input` file (generated by the clustering codebase, which is converted into a serialized MALLET object)
2. Remove the prepended header information
3. Verify the format: one document per line, with filename followed by the entire text on a single line (after tokenization, but before removal of stopwords)

#### Running Turbo Topics

**Step 1: Create Required Files**

Run `create_files.py` with your MALLET state file (decompressed) as input:

```bash
python create_files.py [mallet_state_file]
```

This creates two files:
- `assignments.txt` - topic assignments
- `words.txt` - vocabulary file

**Step 2: Run LDA Topics**

You now have the three files that `lda_topics.py` expects:
- `assignments.txt` - assignments file
- `words.txt` - vocabulary file
- `corpus.txt` - corpus file (from Step 1 above)

Run the topic analysis:

```bash
python lda_topics.py --assign=assignments.txt --corpus=corpus.txt --vocab=words.txt --out=gc_output/ --pval=0.001 --min-count=25 --perm --ntopics=150
```

**Important parameters:**
- `--out` - Must be a directory path with trailing slash for `add_to_database.py` to work correctly
- `--ntopics` - Must match the number of topics used when running MALLET to produce the state file

**Note:** This process may take several days to complete.

**Step 3: Add to Database**

After `lda_topics.py` finishes, add the results to the database.

Run from the same location where the Django server runs (so it finds the database correctly):

```bash
python turbo_topics/add_to_database.py -d gc -a lda150topics -o turbo_topics/gc_output/
```

**Parameters:**
- `-d` - Database name of the dataset
- `-a` - Database name of the analysis
- `-o` - Output directory (same as `--out` specified when running Turbo Topics)

---

## Additional Notes

There are other parameters available in `lda_topics.py` for fine-tuning. Consult the source code or David Blei's original documentation for details.
