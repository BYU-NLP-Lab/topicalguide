{% extends "base.html" %}
{% comment %}
The Topic Browser
Copyright 2010-2011 Brigham Young University

This file is part of the Topic Browser <http://nlp.cs.byu.edu/topic_browser>.

The Topic Browser is free software: you can redistribute it and/or modify it
under the terms of the GNU Affero General Public License as published by the
Free Software Foundation, either version 3 of the License, or (at your option)
any later version.

The Topic Browser is distributed in the hope that it will be useful, but
WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
FITNESS FOR A PARTICULAR PURPOSE.  See the GNU Affero General Public License
for more details.

You should have received a copy of the GNU Affero General Public License along
with the Topic Browser.  If not, see <http://www.gnu.org/licenses/>.

If you have inquiries regarding any further use of the Topic Browser, please
contact the Copyright Licensing Office, Brigham Young University, 3760 HBLL,
Provo, UT 84602, (801) 422-9339 or 422-3821, e-mail copyright@byu.edu.
{% endcomment %}

{% block sidebar %}
	<ul class="list centered">
		{% for dset in datasets %}
		<li class="list{% ifequal dset curdataset %} highlight{% endifequal %}">
			<a href="/datasets/{{ dset.name }}">{{ dset.name }}</a>
		</li>
		{% endfor %}
	</ul>
{% endblock %}

{% block presentation_area %}
<table>
		<tr>
		<td class="align-top"  width="50%">
		<table>
			<tr>
				<td class="align-top">Description
					<table class="inset">
						<tr>
							<td>{{ curdataset.description|linebreaks }}</td>
						</tr>
					</table>
				</td>
			</tr>
			<tr>
				<td class="align-top">Analyses
					<table class="inset">
						{% if not analyses %}
						<tr><td>There are not currently any analyses for this dataset</td><tr>
						{% endif %}
						{% for analysis in analyses %}
						<tr>
							{% ifequal analysis curanalysis%}
							<td class="list highlight">
							{% else %}
							<td class="list">
							{% endifequal %}
								<a href="/datasets/{{ dataset }}/analyses/{{ analysis.name }}">{{ analysis.name }}</a>
							</td>
						</tr>
						{% endfor %}
					</table>
				</td>
			</tr>
			{% if curanalysis %}
			<tr>
				<td class="align-top">Current Analysis Description
					<table class="inset">
						<tr>
							<td>{{ curanalysis.description|linebreaks }}</td>
						</tr>
					</table>
				</td>
			</tr>
			
            <tr>
                <td><img name="plot_image" id="plot_image" src="/site-media/ajax-loader.gif"/></td>
            </tr>
			
			{% endif %}
		</table>
		</td>
	</tr>
</table>

<script charset="utf=8" type="text/javascript">
    update_plot();
</script>
{% endblock %}

{% block scripts %}
<script charset="utf=8" type="text/javascript">
function update_plot() {
    $("img#plot_image").attr("src", "/site-media/ajax-loader.gif");
    var url_base = "/feeds/topic-attribute-plot/";

    url_base += 'attributes/'+{{ sample_attribute }}+'/';
    
    var values = {{ sample_attrvalues }};
    url_base += "values/" + values[0];
    for (var i = 1; i < values.length; i++) {
        url_base += "." + values[i];
    }
    
    url_base += "/topics/";
    var topics = {{ sample_topics }};
    url_base += topics[0];
    for (var i = 1; i < topics.length; i++) {
        url_base += "." + topics[i];
    }

    $("img#plot_image").attr("src", url_base);
}
</script>
{% endblock %}
